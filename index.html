<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="cmssh : Interactive shell for CMS experiment" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>cmssh</title>
  </head>

<body>

<!-- HEADER -->
<div id="header_wrap" class="outer">
<header class="inner">
<a id="forkme_banner" href="https://github.com/dmwm/cmssh">Fork Me on GitHub</a>

<h1 id="project_title">cmssh</h1>
<h2 id="project_tagline">CMS-aware shell</h2>

<!--
          <section id="downloads">
            <a class="zip_download_link" href="https://github.com/dmwm/cmssh/zipball/1.0.1">Download this project as a .zip file</a>
            <a class="tar_download_link" href="https://github.com/dmwm/cmssh/tarball/1.0.1">Download this project as a tar.gz file</a>
            <a class="zip_download_link" href="https://github.com/dmwm/cmssh/zipball/master">Download this project as a .zip file</a>
            <a class="tar_download_link" href="https://github.com/dmwm/cmssh/tarball/master">Download this project as a tar.gz file</a>
          </section>
-->
</header>
</div>

<!-- MAIN CONTENT -->
<div id="main_content_wrap" class="outer">
<section id="main_content" class="inner">

<h1>Welcome to cmssh project.</h1>

<p>
The cmssh (CMS shell) is a part of <a href="http://cms.cern.ch/">CMS</a>
software initiative to simplify your daily activity in CMS environment.
It as combination of data discovery, file mover and release
management tools in one user-friendly shell which runs on your favorite
OS, e.g. Mac or Linux. The code is based on <a href="http://ipython.org/">IPython</a>
project and provides access to find your favorite data, copies LFNs from/to
storage elements and local disk and manages your CMS releases, etc.
Python code base allows you to extend it in any direction and use
any 3-d party python libraries.

A brief introduction of cmssh capabilities is outlined in
<a href="https://indico.cern.ch/conferenceDisplay.py?confId=217263">cmssh tutorial</a>.

</p>

<h1>Prerequisites</h1>
<ul>
<li>
cmssh relies on usage of your GRID certificate. Please ensure that
it is located in $HOME/.globus area, e.g. you should have there
your private key (userkey.pem) and public certificate (usercert.pem).
</li>
<li>
cmssh supports access to CMS RunSummary data-service. The access to this
service requires CERN SSO authentication. To make it work please check that
your user certificate is mapped at
https://ca.cern.ch/ca/Certificates/MapCertificate.aspx
</li>
<li>
If you intend to install cmssh on Mac OS X (Snow Leopard/Lion/Mountain Lion)
please ensure that you have Xcode installed on your Mac. It can be found
from AppleStore or here is direct 
<a href="https://developer.apple.com/xcode/">link</a>.
Mountain Lion users please install <a href="http://bit.ly/TIdOgS">command line tools</a>
and <a href="http://bit.ly/NoAmkv">Java</a>.
</li>
</ul>

<h1>Installation</h1>
To install cmssh please download 
<a href="https://raw.github.com/dmwm/cmssh/1.0.1/cmssh_install.py">installer script</a>
and run it as
<pre>
python cmssh_install.py --help
</pre>
It will print out all options you can use during install procedure. Most of the time
you'll run it as simple as
<pre>
python cmssh_install.py --install --dir=$PWD
</pre>
Please note that python should be version 2.6 or above (but not python 3 yet) and
you'll need to have your JAVA_HOME environment set, since cmssh uses GRID middleware
based on java. But don't worry the install script will prompt you about that.

<h3>Installtion within CMSSW environment</h3>
If you want to install cmssh on a system with already existing CMSSW environment
please use the following command:
<pre>
python ./cmssh_install.py -i -d YOUR_INSTALL_AREA -v 1 \
--cmssw=YOUR_CMSSW_AREA --arch=YOUR_FAVORITE_ARCHITECTURE --multi-user
</pre>
Please note that if you have multiple architectures in your CMSSW area
you may specify any architecture you like. It will be used to
build cmssh dependencies, but cmssh will be able to use CMSSW release
from different architectures.

<h1>Usage</h1>

<p>
The usage of cmssh is very simple, in fact it is very similar to your
normal shell. Here is a few basic commands you may find interesting:
</p>

<h3>search for some data</h3>

<pre>
find dataset=*CRUZET3*RAW
for r in results():
    print r, type(r)
</pre>

<h3>ls/find/info command</h3>

<pre>
ls /Cosmics/CRUZET3-v1/RAW
info /Cosmics/CRUZET3-v1/RAW
find file dataset=/Cosmics/CRUZET3-v1/RAW
find site dataset=/Cosmics/CRUZET3-v1/RAW
find run=160915
info run=160915
</pre>

<p>
Every time you run a command in cmssh there is
<strong>results()</strong> helper function
which captures its output. It allows you to re-iterate over
last command output.

For example, if you run
<pre>find run=160915</pre>
you can iterate over results again by using

<pre>

for r in results():
    # do something useful with r, e.g.
    print r.initLumi, type(r.initLumi), r.DeliveredLumi, type(r.DeliveredLumi)

</pre>
</p>

<h3>find lumi information</h3>

<pre>

find lumi dataset=/Photon/Run2012A-29Jun2012-v1/AOD
find lumi block=/Photon/Run2012A-29Jun2012-v1/AOD#3e33ce8e-c44d-11e1-9a26-003048f0e1c6
find lumi file=/store/data/Run2012A/Photon/AOD/29Jun2012-v1/0000/001B241C-ADC3-E111-BD1D-001E673971CA.root
find lumi run=190704
find lumi {190704:[1,2,3,4], 201706:[1,2,3,67]}

</pre>

<h3>list/copy LFN to local disk</h3>

<pre>

ls /store/data/CRUZET3/Cosmics/RAW/path/file.root
cp /store/data/CRUZET3/Cosmics/RAW/path/file.root .

</pre>

<h3>SE operations, e.g. list its content, create/delete directory, etc.</h3>

<pre>

du T3_US_Cornell
ls T3_US_Cornell
ls T3_US_Cornell:/store/user/me
mkdir T3_US_Cornell:/store/user/me/foo
rmdir T3_US_Cornell:/store/user/me/foo

</pre>

<h3>copy local file to SE</h3>

<pre>cp file.root T3_US_Cornell:/store/user/me</pre>

<h3>copy LFN from SE to local disk</h3>

<pre>cp T3_US_Cornell:/store/user/me/file.root .</pre>

<h3>delete file on SE</h3>

<pre>rm T3_US_Cornell:/xrootdfs/cms/store/user/me/file.root</pre>

<h3>copy LFN to SE area</h3>

<pre>cp /store/data/CRUZET3/Cosmics/RAW/path/file.root T3_US_Cornell:/store/user/me</pre>

<h3>copy multiple files in background</h3>

<pre>

cp /store/data/CRUZET3/Cosmics/RAW/path/file1.root . &amp;
cp /store/data/CRUZET3/Cosmics/RAW/path/file2.root . &amp;
</pre>

<h3>look-up job's transfer</h3>

<pre>jobs list</pre>

<h3>jobs command</h3>
<pre>

# look-up job information
jobs
jobs list
jobs site=T2_US_UCSD
jobs dashboard

# find user information
find user=oliver
jobs user=AikenOliver

</pre>

<h3>look-up available releases</h3>

<pre>releases  </pre>

<h3>install your favorite release</h3>
If you install cmssh on your system withon --cmssw option, you'll be
able to manually install CMSSW releases by using the following command

<pre>install CMSSW_X_Y_Z</pre>

Once CMSSW release is installed in your shell, you can simply invoke your favorite
release as simple as

<pre>cmsrel CMSSW_X_Y_Z</pre>

This command will setup release area and you'll be ready to use it.

<h3>run cms job</h3>
Once CMSSW release is available in your shell (cmsrel CMSSW_X_Y_Z),
you can run your cms run job as following

<pre>cmsRun runevt_cfg.py</pre>

<h1>Help and Support</h1>

<p>
You can find cmssh help by typing <strong>cmshelp</strong> in your shell.
For more information please contact the <a href="mailto:vkuznet@gmail.com">author</a>.
For bugs please use GitHub
<a href="https://github.com/dmwm/cmssh/issues">tracking system</a>.
</p>

      </section>
    </div>

<!-- FOOTER  -->
<div id="footer_wrap" class="outer">
  <footer class="inner">
    <p class="copyright">cmssh maintained by <a href="http://www.linkedin.com/in/ValentinKuznetsov">Valentin Kuznetsov</a></p>
    <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
  </footer>
</div>

    

</body>
</html>
